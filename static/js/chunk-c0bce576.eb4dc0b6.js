(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c0bce576","chunk-7b2ef568"],{2358:function(t,e,n){"use strict";n("e77c")},3089:function(t,e,n){},"63f6":function(t,e,n){"use strict";n("3089")},"891a":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{padding:"10px"}},[n("v-form-render",{ref:"vFormRef",attrs:{"form-json":t.formJson,"form-data":t.formData,"option-data":t.optionData}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.templatePkId,expression:"templatePkId"}],staticClass:"center"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("保存")])],1)],1)},i=[],r=(n("a9e3"),n("e9c4"),n("89a5")),o={name:"Render",props:{templatePkId:{type:Number,default:function(){return null}},pkId:{type:Number,default:function(){return null}},formData:{type:Object,default:function(){return{}}}},data:function(){return{formJson:{},optionData:{},localTemplatePkId:this.templatePkId,localPkId:this.pkId}},mounted:function(){this.localTemplatePkId||(this.localTemplatePkId=this.$route.query.templatePkId,this.localPkId=this.$route.query.pkId),this.localTemplatePkId&&this.localPkId?this.getFormData():this.getFormJson(this.formData)},methods:{submitForm:function(){var t=this;this.$refs.vFormRef.getFormData().then((function(e){var n=Object.assign(e,{templatePkId:t.localTemplatePkId+"",pkId:t.localPkId});Object(r["e"])(n).then((function(e){t.$message.success("保存成功"),t.localPkId=e.data}))})).catch((function(e){t.$message.error(e)}))},getFormJson:function(t){var e=this,n={pkId:this.localTemplatePkId+""};Object(r["c"])(n).then((function(n){e.$refs.vFormRef.setFormJson(n.data.template),t&&e.$nextTick((function(){e.$refs.vFormRef.setFormData(t)}))}))},getFormData:function(){var t=this,e={pkId:this.localPkId,templatePkId:this.localTemplatePkId+""};Object(r["a"])(e).then((function(e){var n=Object.assign(JSON.parse(JSON.stringify(t.formData)),e.data);t.getFormJson(n)}))}}},s=o,c=(n("2358"),n("2877")),l=Object(c["a"])(s,a,i,!1,null,"6d034acc",null);e["default"]=l.exports},"89a5":function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var a=n("bd2b");t="/app/";function i(e){return Object(a["a"])({url:t+"fromDesigner/insert",method:"post",data:e})}function r(e){return Object(a["a"])({url:t+"fromDesigner/getById",method:"post",data:e})}function o(e){return Object(a["a"])({url:t+"fromDesigner/save",method:"post",data:e})}function s(e){return Object(a["a"])({url:t+"fromDesigner/get",method:"post",data:e})}function c(e){return Object(a["a"])({url:t+"fromDesigner/getByExistTable",method:"post",data:e})}},ce3e:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",{staticStyle:{"padding-top":"10px"}},[n("el-col",{staticClass:"col",attrs:{span:24}},[n("avue-crud",{ref:"crud",attrs:{"table-loading":t.tableLoading,data:t.data,option:t.option,search:t.search,page:t.page},on:{"update:search":function(e){t.search=e},"update:page":function(e){t.page=e},"search-change":t.searchChange,"search-reset":t.resetChange,"refresh-change":t.refreshChange,"size-change":t.sizeChange,"current-change":t.currentChange},scopedSlots:t._u([{key:"menu",fn:function(e){var a=e.row,i=e.index;return t._l(t.inLineButton,(function(e,r){return n("el-button",{key:r,attrs:{type:"primary",icon:e.icon,size:"small"},on:{click:function(n){"行删除"==e.name?t.deleteBatch(a,i):t.callMethod(e.clickEvent,a)}}},[t._v(t._s(e.name))])}))}}])},[n("template",{slot:"searchMenu"},t._l(t.headButton,(function(e,a){return n("el-button",{key:a,attrs:{type:"行保存"!=e.name?"primary":"success",icon:e.icon,size:"small"},on:{click:function(n){"行保存"==e.name?t.saveBatch():"行新增"==e.name?t.addBatch():t.callMethod(e.clickEvent)}}},[t._v(t._s(e.name))])})),1),t.showSearch?n("template",{slot:"menuLeft"},t._l(t.headButton,(function(e,a){return n("el-button",{key:a,attrs:{type:"行保存"!=e.name?"primary":"success",icon:e.icon,size:"small"},on:{click:function(n){"行保存"==e.name?t.saveBatch():"行新增"==e.name?t.addBatch():t.callMethod(e.clickEvent)}}},[t._v(t._s(e.name))])})),1):t._e()],2)],1),n("el-dialog",{attrs:{visible:t.form.dialogVisible},on:{"update:visible":function(e){return t.$set(t.form,"dialogVisible",e)},closed:function(e){return t.refreshChange()}}},[t.form.dialogVisible?n("form-render",{attrs:{"template-pk-id":t.form.templatePkId,"pk-id":t.form.pkId,"form-data":t.list.formData}}):t._e()],1),n("el-dialog",{attrs:{visible:t.listRender.dialogVisible},on:{"update:visible":function(e){return t.$set(t.listRender,"dialogVisible",e)}}},[t.listRender.dialogVisible?n("list-render",{attrs:{"sub-list-template-pk-id":t.listRender.listTemplatePkId,"sub-custom-param":t.listRender.customParam,"sub-form-data":t.listRender.formData}}):t._e()],1)],1)},i=[],r=(n("d3b7"),n("3ca3"),n("ddb0"),n("a9e3"),n("4de4"),n("ac1f"),n("841c"),n("b64b"),n("891a")),o=n("f3d5"),s={components:{formRender:r["default"],listRender:function(){return Promise.resolve().then(n.bind(null,"4011"))}},extends:Object(o["a"])(),props:{listTemplatePkId:{type:Number,default:function(){return null}},list:{type:Object,default:function(){return{column:[],button:[],customParam:{},formData:{},rowEdit:!1}},deep:!0}},data:function(){return{form:{dialogVisible:!1,templatePkId:null,pkId:null},listRender:{dialogVisible:!1,listTemplatePkId:null,customParam:{},formData:{}},buttonParam:[],search:{},delPkIds:[],tableLoading:!0,page:{total:0,currentPage:1,pageSize:10},data:[],option:{searchLabelWidth:100,menu:!0,searchShowBtn:!1,searchMenuSpan:null,menuWidth:null,border:!0,refreshBtn:!1,columnBtn:!1,addBtn:!1,editBtn:!1,delBtn:!1,column:[]}}},computed:{inLineButton:function(){var t=this.list.button.filter((function(t){return!t.type}));return this.list.rowEdit&&t.push({icon:"el-icon-delete",name:"行删除"}),t},headButton:function(){var t=this.list.button.filter((function(t){return t.type}));return this.list.rowEdit&&(t.push({icon:"el-icon-plus",name:"行新增"}),t.push({icon:"el-icon-circle-check",name:"行保存"})),t},showSearch:function(){var t=this.option.column.filter((function(t){return!1===t.search})),e=this.list.button.filter((function(t){return t.type}));return this.list.rowEdit&&(e.push({icon:"el-icon-plus",name:"行新增"}),e.push({icon:"el-icon-circle-check",name:"行保存"})),e.length>0&&t.length===this.option.column.length}},watch:{"list.customParam":function(){this.refreshChange()}},created:function(){this.optionInit(),this.dataInit()},methods:{optionInit:function(){this.option.column=this.list.column,this.option.searchMenuSpan=this.headButton.length+5,this.option.menuWidth=100*this.inLineButton.length,this.option.menu=0!==this.inLineButton.length},dataInit:function(t,e){var n=this,a={currentPage:this.page.currentPage,pageSize:this.page.pageSize},i={templatePkId:this.listTemplatePkId+"",page:a};void 0!==t&&(i.search=t);var r=Object(o["c"])();0!==Object.keys(this.list.customParam).length&&(r=Object.assign(r,this.list.customParam)),i.customParam=r,this.tableLoading=!0,Object(o["b"])(i).then((function(t){var a=t.data,i=a.total,r=a.size,o=a.current,s=a.records;n.data=s,n.page.total=i,n.page.currentPage=o,n.page.pageSize=r,void 0!==e&&e(),n.tableLoading=!1}))},sizeChange:function(t){this.page.pageSize=t,this.refreshChange()},currentChange:function(t){this.page.currentPage=t,this.refreshChange()},resetChange:function(){this.dataInit()},searchChange:function(t,e){this.dataInit(t,e)},refreshChange:function(){this.dataInit(this.search)},getQuery:function(t){return Object(o["f"])(t)},addBatch:function(){this.$refs.crud.rowCellAdd(this.list.formData)},saveBatch:function(){var t=this,e={templatePkId:this.listTemplatePkId+"",list:this.data,delPkIds:this.delPkIds};Object(o["i"])(e).then((function(e){t.$message.success("保存成功"),t.delPkIds=[],t.refreshChange()}))},deleteBatch:function(t,e){this.$delete(this.data,e),void 0!==t["pk_id"]&&""!==t["pk_id"]&&this.delPkIds.push(t["pk_id"])}}},c=s,l=(n("63f6"),n("2877")),u=Object(l["a"])(c,a,i,!1,null,null,null);e["default"]=u.exports},e77c:function(t,e,n){}}]);
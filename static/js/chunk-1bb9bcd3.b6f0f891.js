(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1bb9bcd3"],{"0a1b":function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return i}));var n=a("bd2b");t="/app/";function o(e){return Object(n["a"])({url:t+"vFlow/def/insert",method:"post",data:e})}function r(e){return Object(n["a"])({url:t+"vFlow/def/get",method:"post",data:e})}function s(e){return Object(n["a"])({url:t+"vFlow/def/startAble",method:"post",data:e})}function i(e){return Object(n["a"])({url:t+"vFlow/ins/start",method:"post",data:e})}},"1fa5":function(t,e,a){"use strict";a("9667")},"5c83":function(t,e,a){},"7beb":function(t,e,a){"use strict";a("5c83")},"891a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{padding:"10px"}},[a("v-form-render",{ref:"vFormRef",attrs:{"form-json":t.formJson,"form-data":t.formData,"data-dic-api":t.dataDicApi,"option-data":t.optionData}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showButton,expression:"showButton"}],staticClass:"center"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v(t._s(null!=t.localDefId?"保存并流转":"保存"))])],1),a("el-dialog",{attrs:{visible:t.showCheckBox,"append-to-body":""},on:{"update:visible":function(e){t.showCheckBox=e}}},[t.showCheckBox?a("check-box",{attrs:{"candidate-users":t.candidateUsers,"candidate-groups":t.candidateGroups,"form-start":!0},on:{checkDone:t.startFlow}}):t._e()],1)],1)},o=[],r=(a("a9e3"),a("e9c4"),a("89a5")),s=a("5f87"),i=a("ad66"),c=a("ca33"),u={name:"Render",components:{checkBox:c["default"]},props:{templatePkId:{type:Number,default:function(){return null}},pkId:{type:Number,default:function(){return null}},defId:{type:String,default:function(){return null}},candidateUsers:{type:Array,default:function(){return[]}},candidateGroups:{type:Array,default:function(){return[]}},hasAssignee:{type:Boolean,default:function(){return!1}},formData:{type:Object,default:function(){return{}}}},data:function(){return{dataDicApi:{URL:i["a"]+"user/sysCode/listEnum",headers:{Authorization:Object(s["a"])()},key:"fkId"},formJson:{},optionData:{},localTemplatePkId:this.templatePkId,localPkId:this.pkId,localDefId:this.defId,localProId:null,localAssignee:null,showButton:!1,showCheckBox:!1}},mounted:function(){this.localTemplatePkId||(this.localTemplatePkId=this.$route.query.templatePkId,this.localPkId=this.$route.query.pkId),this.localTemplatePkId&&this.localPkId?this.getFormData():this.getFormJson(this.formData)},methods:{submitForm:function(){var t=this;this.$refs.vFormRef.getFormData().then((function(e){t.localDefId&&null==t.localProId?t.hasAssignee?t.saveData(e):t.candidateUsers.length>0||t.candidateGroups.length>0?t.showCheckBox=!0:t.$message.error("当前流程未配置受理人，且未配置候选组/候选用户，无法启动。"):t.saveData(e)})).catch((function(e){t.$message.error(e)}))},startFlow:function(t){var e=this;this.showCheckBox=!1,this.localAssignee=t,this.$refs.vFormRef.getFormData().then((function(t){e.saveData(t)})).catch((function(t){e.$message.error(t)}))},saveData:function(t){var e=this,a={form:t,flow:{defId:this.localDefId,assignee:this.localAssignee,proId:this.localProId},pkId:this.localPkId,templatePkId:this.localTemplatePkId};Object(r["e"])(a).then((function(t){e.$message.success("保存成功");var a=t.data,n=a.pkId,o=a.flow;e.localPkId=n,e.localDefId=o.defId,e.localProId=o.proId}))},getFormJson:function(t){var e=this;Object(r["c"])({pkId:this.localTemplatePkId}).then((function(a){e.$refs.vFormRef.setFormJson(a.data.template),t&&e.$nextTick((function(){e.$refs.vFormRef.setFormData(t),e.showButton=!0}))}))},getFormData:function(){var t=this;Object(r["a"])({pkId:this.localPkId,templatePkId:this.localTemplatePkId}).then((function(e){var a=e.data,n=a.flow,o=a.form,r=Object.assign(JSON.parse(JSON.stringify(t.formData)),o);t.getFormJson(r),t.localDefId=n.defId,t.localProId=n.proId}))}}},d=u,l=(a("7beb"),a("2877")),f=Object(l["a"])(d,n,o,!1,null,"1a0844da",null);e["default"]=f.exports},"89a5":function(t,e,a){"use strict";a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"e",(function(){return s})),a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return c}));var n=a("bd2b");t="/app/";function o(e){return Object(n["a"])({url:t+"fromDesigner/insert",method:"post",data:e})}function r(e){return Object(n["a"])({url:t+"fromDesigner/getById",method:"post",data:e})}function s(e){return Object(n["a"])({url:t+"fromDesigner/save",method:"post",data:e})}function i(e){return Object(n["a"])({url:t+"fromDesigner/get",method:"post",data:e})}function c(e){return Object(n["a"])({url:t+"fromDesigner/getByExistTable",method:"post",data:e})}},9667:function(t,e,a){},ca33:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tt"},[a("avue-form",{ref:"formRef",attrs:{option:t.option},on:{submit:t.startFlow},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}})],1)},o=[],r=(a("d81d"),a("c24f")),s=a("ad66"),i=a("0a1b"),c={name:"",props:{defId:{type:String,default:function(){return null}},candidateUsers:{type:Array,default:function(){return[]}},candidateGroups:{type:Array,default:function(){return[]}},formStart:{type:Boolean,default:function(){return!1}}},data:function(){var t=this;return{form:{candidateUsers:null},assignee:null,option:{submitText:"发起流程",emptyBtn:!1,labelPosition:"top",group:[{label:"候选用户",arrow:!1,prop:"group2",column:[{label:"",prop:"candidateUsers",type:"radio",dicUrl:s["a"]+"user/sysUser/getUserByIds",dicMethod:"post",dicQuery:{ids:this.candidateUsers},span:24,click:function(e){if("INPUT"!==e.event.target.tagName)return!1;var a=e.column;return t.check(a["prop"])}}]},{label:"候选组",arrow:!1,prop:"group3",column:[]}],column:[]}}},created:function(){this.init()},methods:{init:function(){var t=this;this.option.group[1].column=Object(r["c"])({ids:this.candidateGroups}).map((function(e){return{label:e.label,prop:"candidateGroups"+e.value,type:"radio",dicData:e.children,span:24,click:function(e){if("INPUT"!==e.event.target.tagName)return!1;var a=e.column;return t.check(a["prop"])}}}))},check:function(t){var e=this.$refs.formRef.form;for(var a in e)a!==t&&(e[a]=void 0);return this.assignee=t,!0},startFlow:function(t,e){var a=this;null==this.assignee?(e(),this.$message.error("请选择处理人")):this.formStart?(e(),this.$emit("checkDone",t[this.assignee])):Object(i["c"])({defId:this.defId,assignee:t[this.assignee]}).then((function(t){a.$message.success("流程启动成功，请返回我发起的查询发起任务"),e(),a.$emit("checkDone")}))}}},u=c,d=(a("1fa5"),a("2877")),l=Object(d["a"])(u,n,o,!1,null,"31cd3c5d",null);e["default"]=l.exports}}]);
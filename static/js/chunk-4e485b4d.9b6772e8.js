(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e485b4d"],{"30b50":function(e,t,n){e.exports=n.p+"static/img/card.818dc5fe.png"},"3fdb":function(e,t,n){e.exports=n.p+"static/img/btn_bujiao.05d5cdca.png"},b276:function(e,t,n){"use strict";n.r(t),n.d(t,"deal",(function(){return l})),n.d(t,"methods",(function(){return p})),n.d(t,"websocketTest",(function(){return g}));n("b680"),n("ace4"),n("d3b7"),n("cfc3"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("d81d"),n("4e82"),n("fb6a"),n("159b"),n("b0c0"),n("caad"),n("2532"),n("a434"),n("e9c4");var i=n("5a89"),r=n("30b50"),a=n.n(r),o=n("b688"),s=n.n(o),d=n("3fdb"),h=n.n(d),c=n("f8e6"),u=n.n(c),m={0:{name:"大王",x:710,y:646,index:0},1:{name:"小王",x:592,y:646,index:1},2:{name:"♠2",x:710,y:485,index:2},3:{name:"♣2",x:1064,y:163,index:3},4:{name:"♦2",x:474,y:163,index:4},5:{name:"♥2",x:946,y:324,index:5},6:{name:"♠A",x:828,y:485,index:6},7:{name:"♣A",x:1182,y:163,index:7},8:{name:"♦A",x:238,y:2,index:8},9:{name:"♥A",x:1064,y:324,index:9},10:{name:"♠K",x:828,y:646,index:10},11:{name:"♣K",x:1182,y:324,index:11},12:{name:"♦K",x:1300,y:163,index:12},13:{name:"♥K",x:1064,y:485,index:13},14:{name:"♠Q",x:946,y:646,index:14},15:{name:"♣Q",x:1300,y:324,index:15},16:{name:"♦Q",x:1418,y:163,index:16},17:{name:"♥Q",x:1182,y:485,index:17},18:{name:"♠J",x:1064,y:646,index:18},19:{name:"♣J",x:1418,y:324,index:19},20:{name:"♦J",x:2,y:2,index:20},21:{name:"♥J",x:1300,y:485,index:21},22:{name:"♠10",x:1300,y:646,index:22},23:{name:"♣10",x:2,y:163,index:23},24:{name:"♦10",x:120,y:2,index:24},25:{name:"♥10",x:1418,y:485,index:25},26:{name:"♠9",x:1418,y:646,index:26},27:{name:"♣9",x:120,y:163,index:27},28:{name:"♦9",x:2,y:646,index:28},29:{name:"♥9",x:2,y:324,index:29},30:{name:"♠8",x:2,y:485,index:30},31:{name:"♣8",x:238,y:163,index:31},32:{name:"♦8",x:120,y:646,index:32},33:{name:"♥8",x:120,y:324,index:33},34:{name:"♠7",x:120,y:485,index:34},35:{name:"♣7",x:356,y:163,index:35},36:{name:"♦7",x:238,y:646,index:36},37:{name:"♥7",x:238,y:324,index:37},38:{name:"♠6",x:238,y:485,index:38},39:{name:"♣6",x:592,y:163,index:39},40:{name:"♦6",x:356,y:646,index:40},41:{name:"♥6",x:356,y:324,index:41},42:{name:"♠5",x:356,y:485,index:42},43:{name:"♣5",x:710,y:163,index:43},44:{name:"♦5",x:1182,y:646,index:44},45:{name:"♥5",x:474,y:324,index:45},46:{name:"♠4",x:474,y:485,index:46},47:{name:"♣4",x:828,y:163,index:47},48:{name:"♦4",x:946,y:485,index:48},49:{name:"♥4",x:592,y:324,index:49},50:{name:"♠3",x:592,y:485,index:50},51:{name:"♣3",x:946,y:163,index:51},52:{name:"♦3",x:710,y:324,index:52},53:{name:"♥3",x:828,y:324,index:53},54:{name:"背面",x:474,y:646,index:54}},x=function(e,t){var n=(e/1550).toFixed(5),i=(t/809).toFixed(5),r=((e+116)/1550).toFixed(5),a=((t+159)/809).toFixed(5),o=new Float32Array([n,a,r,a,n,i,r,i]);return o},f=function(e,t){var n=new Float32Array([0,1,1,1,0,0,1,0]);return n},l=function(){var e=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53];function t(e,t){return e-t}Array.prototype.deranged||(Array.prototype.deranged=function(){for(var e,t,n=this.length;n;e=parseInt(Math.random()*n),t=this[--n],this[n]=this[e],this[e]=t);return this});var n=e.deranged(),i=n.slice(0,17).sort(t).map((function(e){return m[e]})),r=n.slice(17,34).sort(t).map((function(e){return m[e]})),a=n.slice(34,51).sort(t).map((function(e){return m[e]})),o=n.slice(51,54).sort(t).map((function(e){return m[e]})),s=[54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54],d=s.map((function(e){return m[e]}));return[i,r,a,o,d]},p={data:function(){return{bgWidth:1136,bgHeight:768,cdWidth:116,cdHeight:159,moveHeight:20,scene:new i["i"],camera:null,renderer:null,gui:null,leftGroup:new i["c"],rightGroup:new i["c"],mainGroup:new i["c"],outGroup:new i["c"],topGroup:new i["c"],checkMesh:[],buttonGroup:new i["c"]}},methods:{initCardMaterial:function(){return new i["e"]({map:(new i["j"]).load(a.a),transparent:!0})},initButtonMaterial:function(e){return new i["e"]({map:(new i["j"]).load(e),transparent:!0})},initBackGround:function(){var e=new i["e"]({map:(new i["j"]).load(s.a),transparent:!0}),t=new i["d"](new i["g"](this.bgWidth,this.bgHeight),e);t.position.set(0,0,0),this.scene.add(t)},leftPalyer:function(e){var t=this;e.forEach((function(e){var n=new i["g"](t.cdWidth,t.cdHeight);n.attributes.uv=new i["b"](x(e.x,e.y),2),t.leftGroup.add(new i["d"](n,t.initCardMaterial()))}));var n=this.leftGroup.children;n.forEach((function(e){return e.rotateZ(1.55)}));for(var r=20,a=(this.bgWidth-this.cdHeight)/2,o=(this.cdHeight-(n.length*r+this.cdWidth))/2,s=0;s<n.length;s++)n[s].position.set(0-a,o+s*r,s+1);this.scene.add(this.leftGroup)},rightPalyer:function(e){var t=this;e.forEach((function(e){var n=new i["g"](t.cdWidth,t.cdHeight);n.attributes.uv=new i["b"](x(e.x,e.y),2),t.rightGroup.add(new i["d"](n,t.initCardMaterial()))}));var n=this.rightGroup.children;n.forEach((function(e){return e.rotateZ(1.55)}));for(var r=20,a=(this.bgWidth-this.cdHeight)/2,o=(this.cdHeight-(n.length*r+this.cdWidth))/2,s=0;s<n.length;s++)n[s].position.set(a,o+s*r,s+1);this.scene.add(this.rightGroup)},sidePalyer:function(e){this.leftPalyer(e),this.rightPalyer(e)},bottomPalyer:function(e){var t=this;e.forEach((function(e){var n=new i["g"](t.cdWidth,t.cdHeight);n.attributes.uv=new i["b"](x(e.x,e.y),2);var r=new i["d"](n,t.initCardMaterial());r.name=e.index,t.mainGroup.add(r)})),this.bottomPosition(),this.scene.add(this.mainGroup)},topPalyer:function(e){var t=this;e.forEach((function(e){var n=new i["g"](t.cdWidth,t.cdHeight);n.attributes.uv=new i["b"](x(e.x,e.y),2),t.topGroup.add(new i["d"](n,t.initCardMaterial()))}));for(var n=this.topGroup.children,r=40,a=0-(n.length-1)*r/2,o=(this.bgHeight-this.cdHeight)/2,s=0;s<n.length;s++)n[s].position.set(a+s*r,o,s+1);this.scene.add(this.topGroup)},button:function(){var e=this,t=[{pic:u.a,index:"chupai"},{pic:h.a,index:"buchu"}],n=211,r=84;t.forEach((function(t){var a=new i["g"](n,r);a.attributes.uv=new i["b"](f(),2);var o=new i["d"](a,e.initButtonMaterial(t.pic));o.name=t.index,e.buttonGroup.add(o)}));for(var a=this.buttonGroup.children,o=n,s=0-(a.length-1)*o/2,d=0-(this.bgHeight-r)/2+this.cdHeight+2*this.moveHeight,c=0;c<a.length;c++)a[c].position.set(s+c*o,d,1);this.scene.add(this.buttonGroup)},bottomPosition:function(){for(var e=this.mainGroup.children,t=40,n=0-(e.length-1)*t/2,i=0-(this.bgHeight-this.cdHeight)/2,r=0;r<e.length;r++)e[r].position.set(n+r*t,i,r+1)},outPosition:function(){for(var e=this.outGroup.children,t=40,n=0-(e.length-1)*t/2,i=0,r=0;r<e.length;r++)e[r].position.set(n+r*t,i,r+1)},initCamera:function(){var e=this.bgWidth/this.bgHeight,t=this.bgHeight/2;this.camera=new i["f"](-t*e,t*e,t,-t,1,2e3),this.camera.position.set(0,0,100),this.camera.lookAt(0,0,0)},reloadCamera:function(){var e,t;this.$route.fullPath.includes("index")?this.renderer.setSize(window.innerWidth,window.innerHeight):this.renderer.setSize(window.innerWidth,window.innerHeight-84),window.innerWidth<500?(e=this.bgHeight/this.bgWidth,t=this.bgWidth/2,this.camera.up.set(-1,0,0)):(e=this.bgWidth/this.bgHeight,t=this.bgHeight/2,this.camera.up.set(0,1,0)),this.camera.left=-t*e,this.camera.right=t*e,this.camera.top=t,this.camera.bottom=-t,this.camera.lookAt(0,0,0),this.camera.updateProjectionMatrix()},initRenderer:function(){this.scene.add(this.outGroup),this.scene.add(new i["a"](150)),this.renderer=new i["l"]({antialias:!0}),this.reloadCamera(),this.renderer.render(this.scene,this.camera);var e=this.scene,t=this.camera,n=this.renderer;function r(){n.render(e,t),requestAnimationFrame(r)}r(),document.getElementById("three").appendChild(this.renderer.domElement);var a=this;window.onresize=function(){a.reloadCamera()},this.renderer.domElement.addEventListener("click",(function(e){var n=e.offsetX/window.innerWidth*2-1,r=-e.offsetY/window.innerHeight*2+1,o=new i["h"];o.setFromCamera(new i["k"](n,r),t);var s=o.intersectObjects(a.mainGroup.children);if(s.length>0)a.checkCard(s[0].object);else{var d=o.intersectObjects(a.buttonGroup.children);d.length>0&&a.outCard(d[0].object.name)}}))},checkCard:function(e){var t=this.checkMesh.indexOf(e);-1!==t?(this.checkMesh.splice(t,1),e.position.y-=this.moveHeight):(this.checkMesh.push(e),e.position.y+=this.moveHeight)},outCard:function(e){var t=this;if("buchu"===e)this.checkMesh.forEach((function(e){e.position.y-=t.moveHeight})),this.checkMesh=[];else{var n=this.checkMesh.map((function(e){return e.name}));if(!this.outCard)return void console.log("还不到您CP");this.post(n)}},removeCard:function(){for(var e=this,t=this.outGroup.children,n=t.length-1,i=n;i>=0;i--)this.outGroup.remove(t[i]);this.checkMesh.forEach((function(t){e.outGroup.add(t),e.mainGroup.remove(t)})),this.outPosition(),this.bottomPosition(),this.checkMesh=[]},outCardByOther:function(e){for(var t=this,n=this.outGroup.children,i=n.length-1,r=i;r>=0;r--)this.outGroup.remove(n[r]);e.forEach((function(e){t.outGroup.add(e)})),this.outPosition()}}},g={init:function(e,t){var n=new WebSocket("ws://120.24.168.1:8005/im/socket/message?token="+e),i=function(){n.send(JSON.stringify({method:"ready"})),console.log("客户端连接成功",e)},r=function(i){var r=JSON.parse(i.data),a=r.state;switch(console.log(e,r),a){case 3:var o={method:"agree",key:r.key};n.send(JSON.stringify(o));break;case 4:var s=r.outCard,d=r.cards,h=r.bottomCard;if(null!=t){t.palyers.outCard=s,t.palyers.cards=d;var c=d.map((function(e){return m[e]}));t.bottomPalyer(c);var u=h.map((function(e){return m[e]}));t.topPalyer(u)}else s&&n.send(JSON.stringify({method:"play",cards:[]}));break;case 5:break;case 6:var x=r.outCard,f=r.cards;if(null!=t){if(t.palyers.outCard=x,f.length>0){var l=f.map((function(e){return m[e]}));t.outCardByOther(l)}}else x&&n.send(JSON.stringify({method:"play",cards:[]}));break;case 99:break;case 100:null!=t&&t.removeCard();break}};return n.onopen=i,n.onmessage=r,n}}},b688:function(e,t,n){e.exports=n.p+"static/img/table_bg_1.7f3bf7bc.jpg"},ed17:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"three"}})},r=[],a=(n("e9c4"),n("b276")),o=n("c24f"),s={name:"App",components:{},extends:a["methods"],data:function(){return{user:{},websock:[],palyers:{outCard:!1,cards:[]}}},created:function(){this.initUser()},mounted:function(){this.init()},methods:{initUser:function(){var e=this;Object(o["b"])().then((function(t){var n=t.data.pkId;e.user={id:n},e.initWebSocket()}))},initWebSocket:function(){this.websock.push(a["websocketTest"].init(this.user.id,this)),this.websock.push(a["websocketTest"].init(2)),this.websock.push(a["websocketTest"].init(3))},init:function(){this.initBackGround();var e=Object(a["deal"])();this.sidePalyer(e[4]),this.button(),this.initCamera(),this.initRenderer()},post:function(e){var t={method:"play",cards:e};return this.websock[0].send(JSON.stringify(t)),!1}}},d=s,h=n("2877"),c=Object(h["a"])(d,i,r,!1,null,null,null);t["default"]=c.exports},f8e6:function(e,t,n){e.exports=n.p+"static/img/btn_chupai.ce997572.png"}}]);